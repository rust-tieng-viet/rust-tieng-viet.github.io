<!DOCTYPE HTML>
<html lang="vi" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Box&lt;T&gt; - Rust Tiếng Việt</title>


        <!-- Custom HTML head -->
        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-88RKF7DLPY"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
        
          gtag('config', 'G-88RKF7DLPY');
        </script>
        
        <!-- pageview.js -->
        <script>
          !function(e,n,t){e.onload=function(){
          let e=n.createElement("script");
          e.src=t,n.body.appendChild(e)}}
          (window,document,"https://pageview.duyet.net/pageview.js");
        </script>

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../index.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="../who-is-using.html"><strong aria-hidden="true">2.</strong> Who is using?</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Bắt đầu</li><li class="chapter-item expanded "><a href="../getting-started/installation.html"><strong aria-hidden="true">3.</strong> Cài đặt Rust</a></li><li class="chapter-item expanded "><a href="../getting-started/first-project.html"><strong aria-hidden="true">4.</strong> Project đầu tiên</a></li><li class="chapter-item expanded affix "><li class="part-title">Cơ bản</li><li class="chapter-item expanded "><a href="../basic/variables/index.html"><strong aria-hidden="true">5.</strong> Variables</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../basic/variables/mut.html"><strong aria-hidden="true">5.1.</strong> mut</a></li><li class="chapter-item expanded "><a href="../basic/variables/uninitialized.html"><strong aria-hidden="true">5.2.</strong> uninitialized variable</a></li></ol></li><li class="chapter-item expanded "><a href="../basic/closure.html"><strong aria-hidden="true">6.</strong> Closure</a></li><li class="chapter-item expanded "><a href="../basic/cargo/index.html"><strong aria-hidden="true">7.</strong> Cargo</a></li><li class="chapter-item expanded "><a href="../basic/package-crate/index.html"><strong aria-hidden="true">8.</strong> Packages và Crates</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../basic/package-crate/package-layout.html"><strong aria-hidden="true">8.1.</strong> Package layout</a></li><li class="chapter-item expanded "><a href="../basic/package-crate/crate.html"><strong aria-hidden="true">8.2.</strong> Crate</a></li><li class="chapter-item expanded "><a href="../basic/package-crate/use-crate/index.html"><strong aria-hidden="true">8.3.</strong> use crate</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../basic/package-crate/use-crate/self-super.html"><strong aria-hidden="true">8.3.1.</strong> use self, use super</a></li><li class="chapter-item expanded "><a href="../basic/package-crate/use-crate/pub-use.html"><strong aria-hidden="true">8.3.2.</strong> pub use</a></li></ol></li><li class="chapter-item expanded "><a href="../basic/package-crate/preludes.html"><strong aria-hidden="true">8.4.</strong> Preludes</a></li></ol></li><li class="chapter-item expanded "><a href="../basic/ownership.html"><strong aria-hidden="true">9.</strong> Ownership</a></li><li class="chapter-item expanded "><a href="../basic/struct.html"><strong aria-hidden="true">10.</strong> Struct</a></li><li class="chapter-item expanded "><a href="../basic/trait/index.html"><strong aria-hidden="true">11.</strong> Trait</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../basic/trait/define-a-trait.html"><strong aria-hidden="true">11.1.</strong> Khai báo Trait</a></li><li class="chapter-item expanded "><a href="../basic/trait/impl-trait.html"><strong aria-hidden="true">11.2.</strong> Implement Trait cho một Type</a></li><li class="chapter-item expanded "><a href="../basic/trait/default-impls.html"><strong aria-hidden="true">11.3.</strong> Default Implementations</a></li><li class="chapter-item expanded "><a href="../basic/trait/trait-as-params.html"><strong aria-hidden="true">11.4.</strong> Traits as Parameters</a></li><li class="chapter-item expanded "><a href="../basic/trait/trait-bound.html"><strong aria-hidden="true">11.5.</strong> Trait Bound</a></li><li class="chapter-item expanded "><a href="../basic/trait/multiple-trait-bound.html"><strong aria-hidden="true">11.6.</strong> Multiple Trait Bound</a></li><li class="chapter-item expanded "><a href="../basic/trait/where-clauses.html"><strong aria-hidden="true">11.7.</strong> where Clauses</a></li><li class="chapter-item expanded "><a href="../basic/trait/return-impl-trait.html"><strong aria-hidden="true">11.8.</strong> Returning Types that Implement Traits</a></li><li class="chapter-item expanded "><a href="../basic/trait/conditionally-impl.html"><strong aria-hidden="true">11.9.</strong> Using Trait Bounds to Conditionally Implement Methods</a></li><li class="chapter-item expanded "><a href="../basic/trait/blanked-impl.html"><strong aria-hidden="true">11.10.</strong> Blanket implementations</a></li><li class="chapter-item expanded "><a href="../basic/trait/trait-inheritance.html"><strong aria-hidden="true">11.11.</strong> Trait Inheritance</a></li><li class="chapter-item expanded "><a href="../basic/trait/supertraits.html"><strong aria-hidden="true">11.12.</strong> Supertraits</a></li><li class="chapter-item expanded "><a href="../basic/trait/auto-trait.html"><strong aria-hidden="true">11.13.</strong> Auto Trait</a></li><li class="chapter-item expanded "><a href="../basic/trait/copy-clone.html"><strong aria-hidden="true">11.14.</strong> Copy, Clone</a></li><li class="chapter-item expanded "><a href="../basic/trait/string-str.html"><strong aria-hidden="true">11.15.</strong> String và &str</a></li><li class="chapter-item expanded "><a href="../basic/trait/fromstr.html"><strong aria-hidden="true">11.16.</strong> FromStr</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">11.17.</strong> Display</div></li></ol></li><li class="chapter-item expanded "><a href="../basic/enum/index.html"><strong aria-hidden="true">12.</strong> Enum</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../basic/enum/match.html"><strong aria-hidden="true">12.1.</strong> match Enum</a></li><li class="chapter-item expanded "><a href="../basic/enum/use-variants.html"><strong aria-hidden="true">12.2.</strong> Mang Variants ra ngoài scope của Enum</a></li><li class="chapter-item expanded "><a href="../basic/enum/impl.html"><strong aria-hidden="true">12.3.</strong> impl Enum</a></li><li class="chapter-item expanded "><a href="../basic/enum/option/index.html"><strong aria-hidden="true">12.4.</strong> Option&lt;T&gt;</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../basic/enum/option/unwrap.html"><strong aria-hidden="true">12.4.1.</strong> unwrap()</a></li><li class="chapter-item expanded "><a href="../basic/enum/option/expect.html"><strong aria-hidden="true">12.4.2.</strong> expect()</a></li><li class="chapter-item expanded "><a href="../basic/enum/option/unwrap_or_default.html"><strong aria-hidden="true">12.4.3.</strong> unwrap_or_default()</a></li><li class="chapter-item expanded "><a href="../basic/enum/option/if_let_some.html"><strong aria-hidden="true">12.4.4.</strong> if let Some(x) = x</a></li></ol></li><li class="chapter-item expanded "><a href="../basic/enum/result/index.html"><strong aria-hidden="true">12.5.</strong> Result&lt;T, E&gt;</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../basic/enum/result/result-to-option.html"><strong aria-hidden="true">12.5.1.</strong> Convert Result sang Option</a></li><li class="chapter-item expanded "><a href="../basic/enum/result/question-mark.html"><strong aria-hidden="true">12.5.2.</strong> Toán tử ?</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../basic/generics/index.html"><strong aria-hidden="true">13.</strong> Generics</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../basic/generics/functions.html"><strong aria-hidden="true">13.1.</strong> Generic Functions</a></li><li class="chapter-item expanded "><a href="../basic/generics/struct.html"><strong aria-hidden="true">13.2.</strong> Generic Struct</a></li><li class="chapter-item expanded "><a href="../basic/generics/enum.html"><strong aria-hidden="true">13.3.</strong> Generic Enum</a></li><li class="chapter-item expanded "><a href="../basic/generics/impl.html"><strong aria-hidden="true">13.4.</strong> Generic Implementation</a></li><li class="chapter-item expanded "><a href="../basic/generics/trait.html"><strong aria-hidden="true">13.5.</strong> Generic Trait</a></li><li class="chapter-item expanded "><a href="../basic/generics/bounds.html"><strong aria-hidden="true">13.6.</strong> Bounds</a></li><li class="chapter-item expanded "><a href="../basic/generics/where.html"><strong aria-hidden="true">13.7.</strong> where</a></li></ol></li><li class="chapter-item expanded "><a href="../basic/vec/INDEX.html"><strong aria-hidden="true">14.</strong> Vec</a></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">14.1.</strong> Iter</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">14.2.</strong> Sử dụng Enum để chứa nhiều loại dữ liệu</div></li></ol></li><li class="chapter-item expanded "><a href="../basic/code-comment/index.html"><strong aria-hidden="true">15.</strong> /// Viết code comment</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../basic/code-comment/doc-comment.html"><strong aria-hidden="true">15.1.</strong> Doc comments</a></li></ol></li><li class="chapter-item expanded "><a href="../basic/turbofish.html"><strong aria-hidden="true">16.</strong> Turbofish ::&lt;&gt;</a></li><li class="chapter-item expanded "><a href="../basic/macro/index.html"><strong aria-hidden="true">17.</strong> macros!</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../basic/macro/macros-vs-functions.html"><strong aria-hidden="true">17.1.</strong> Khác nhau giữa Macros và Functions</a></li><li class="chapter-item expanded "><a href="../basic/macro/standard-macros.html"><strong aria-hidden="true">17.2.</strong> Macros mặc định</a></li><li class="chapter-item expanded "><a href="../basic/macro/println.html"><strong aria-hidden="true">17.3.</strong> println!</a></li><li class="chapter-item expanded "><a href="../basic/macro/format.html"><strong aria-hidden="true">17.4.</strong> format!</a></li><li class="chapter-item expanded "><a href="../basic/macro/todo.html"><strong aria-hidden="true">17.5.</strong> todo!</a></li><li class="chapter-item expanded "><a href="../basic/macro/macro_rules.html"><strong aria-hidden="true">17.6.</strong> macro_rules!</a></li></ol></li><li class="chapter-item expanded "><a href="../basic/match/index.html"><strong aria-hidden="true">18.</strong> match</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../basic/match/literals.html"><strong aria-hidden="true">18.1.</strong> Matching giá trị</a></li><li class="chapter-item expanded "><a href="../basic/match/named-vars.html"><strong aria-hidden="true">18.2.</strong> Matching Named Variables</a></li><li class="chapter-item expanded "><a href="../basic/match/multiple.html"><strong aria-hidden="true">18.3.</strong> Matching Multiple</a></li></ol></li><li class="chapter-item expanded "><a href="../basic/attr.html"><strong aria-hidden="true">19.</strong> #[attributes]</a></li><li class="chapter-item expanded "><a href="../basic/error-handling/index.html"><strong aria-hidden="true">20.</strong> Xử lý lỗi</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../basic/error-handling/panic.html"><strong aria-hidden="true">20.1.</strong> panic</a></li><li class="chapter-item expanded "><a href="../basic/error-handling/option.html"><strong aria-hidden="true">20.2.</strong> Option</a></li><li class="chapter-item expanded "><a href="../basic/error-handling/result.html"><strong aria-hidden="true">20.3.</strong> Result</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../basic/error-handling/result-map.html"><strong aria-hidden="true">20.3.1.</strong> Result map</a></li><li class="chapter-item expanded "><a href="../basic/error-handling/result-alias.html"><strong aria-hidden="true">20.3.2.</strong> Result alias</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">20.4.</strong> Custom error</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">20.5.</strong> Boxing error</div></li></ol></li><li class="chapter-item expanded "><a href="../basic/testing/index.html"><strong aria-hidden="true">21.</strong> Viết Tests</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../basic/testing/test-organization.html"><strong aria-hidden="true">21.1.</strong> Tổ chức Tests</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../basic/testing/unit-tests.html"><strong aria-hidden="true">21.1.1.</strong> Unit Tests</a></li><li class="chapter-item expanded "><a href="../basic/testing/integration-tests.html"><strong aria-hidden="true">21.1.2.</strong> Integration Tests</a></li><li class="chapter-item expanded "><a href="../basic/testing/doc-tests.html"><strong aria-hidden="true">21.1.3.</strong> Doc Tests</a></li></ol></li><li class="chapter-item expanded "><a href="../basic/testing/env-conflict.html"><strong aria-hidden="true">21.2.</strong> Xung đột biến môi trường</a></li></ol></li><li class="chapter-item expanded "><a href="../basic/rustdoc/index.html"><strong aria-hidden="true">22.</strong> Viết Docs</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../basic/code-comment/doc-comment.html"><strong aria-hidden="true">22.1.</strong> Doc comments</a></li><li class="chapter-item expanded "><a href="../basic/rustdoc/doc-README.html"><strong aria-hidden="true">22.2.</strong> Sử dụng README.md làm crate document</a></li></ol></li><li class="chapter-item expanded "><li class="part-title">Nâng cao</li><li class="chapter-item expanded "><div><strong aria-hidden="true">23.</strong> Smart Pointers</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../advanced/box.html" class="active"><strong aria-hidden="true">23.1.</strong> Box&lt;T&gt;</a></li><li class="chapter-item expanded "><a href="../advanced/rc.html"><strong aria-hidden="true">23.2.</strong> Rc&lt;T&gt;, Reference Counted</a></li><li class="chapter-item expanded "><a href="../advanced/cow.html"><strong aria-hidden="true">23.3.</strong> Cow</a></li></ol></li><li class="chapter-item expanded "><a href="../advanced/saturating.html"><strong aria-hidden="true">24.</strong> Saturating&lt;T&gt;</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Design patterns</li><li class="chapter-item expanded "><a href="../design-pattern/behavioural/index.html"><strong aria-hidden="true">25.</strong> Behavioural Patterns</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../design-pattern/behavioural/strategy.html"><strong aria-hidden="true">25.1.</strong> Strategy Pattern</a></li><li class="chapter-item expanded "><a href="../design-pattern/behavioural/command.html"><strong aria-hidden="true">25.2.</strong> Command Pattern</a></li></ol></li><li class="chapter-item expanded "><a href="../design-pattern/creational/index.html"><strong aria-hidden="true">26.</strong> Creational Patterns</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../design-pattern/creational/builder.html"><strong aria-hidden="true">26.1.</strong> Builder Pattern</a></li></ol></li><li class="chapter-item expanded "><a href="../design-pattern/structural/index.html"><strong aria-hidden="true">27.</strong> Structural Patterns</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../design-pattern/structural/small-rates.html"><strong aria-hidden="true">27.1.</strong> Prefer Small Crates</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><li class="part-title">Crates hay dùng</li><li class="chapter-item expanded "><div><strong aria-hidden="true">28.</strong> tokio</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">29.</strong> actix-web</div></li><li class="chapter-item expanded "><a href="../crates/anyhow.html"><strong aria-hidden="true">30.</strong> anyhow</a></li><li class="chapter-item expanded "><a href="../crates/serde.html"><strong aria-hidden="true">31.</strong> serde</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../crates/serde_json.html"><strong aria-hidden="true">31.1.</strong> serde_json</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">32.</strong> clap</div></li><li class="chapter-item expanded "><a href="../crates/log/index.html"><strong aria-hidden="true">33.</strong> log</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../crates/log/env_logger.html"><strong aria-hidden="true">33.1.</strong> env_logger</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">34.</strong> config</div></li><li class="chapter-item expanded "><a href="../crates/async_trait.html"><strong aria-hidden="true">35.</strong> async_trait</a></li><li class="chapter-item expanded "><a href="../crates/lazy_static.html"><strong aria-hidden="true">36.</strong> lazy_static</a></li><li class="chapter-item expanded "><a href="../crates/indoc.html"><strong aria-hidden="true">37.</strong> indoc</a></li><li class="chapter-item expanded "><a href="../crates/rayon.html"><strong aria-hidden="true">38.</strong> rayon</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Rust Idioms</li><li class="chapter-item expanded "><div><strong aria-hidden="true">39.</strong> Functional programming</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">40.</strong> Use borrowed types for arguments</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">41.</strong> Concatenating strings with format!</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">42.</strong> Constructor</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">43.</strong> The Default Trait</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">44.</strong> Finalisation in destructors</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">45.</strong> Temporary mutability</div></li><li class="chapter-item expanded affix "><li class="part-title">Rust for Data Engineering</li><li class="chapter-item expanded "><a href="../data-engineering/data-processing.html"><strong aria-hidden="true">46.</strong> Using Rust for efficient data processing and analysis</a></li><li class="chapter-item expanded "><a href="../data-engineering/first-data-pipeline.html"><strong aria-hidden="true">47.</strong> First high-performance data pipelines in Rust</a></li><li class="chapter-item expanded "><a href="../data-engineering/data-driven.html"><strong aria-hidden="true">48.</strong> Building scalable data-driven applications using Rust</a></li><li class="chapter-item expanded "><a href="../data-engineering/rust-as-alternative-python.html"><strong aria-hidden="true">49.</strong> Rust as an alternative to Python for data engineering tasks</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Rust Tiếng Việt</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/rust-tieng-viet/rust-tieng-viet.github.io" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/rust-tieng-viet/rust-tieng-viet.github.io/edit/main/src/advanced/box.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="boxt"><a class="header" href="#boxt"><code>Box&lt;T&gt;</code></a></h1>
<p>Tất cả giá trị trên Rust mặc định đều được allocated trên stack. Giá trị có thể được <em>boxed</em>, allocated trên heap bằng cách sử dụng <code>Box&lt;T&gt;</code>.
<code>Box&lt;T&gt;</code> là một smart pointer của Rust cho phép allocated trên heap giá trị có kiểu <code>T</code>, còn pointer trỏ đến giá trị đó sẽ nằm trên stack.
<a href="https://doc.rust-lang.org/book/ch04-01-what-is-ownership.html#the-stack-and-the-heap">Xem thêm về stack và heap tại đây</a>.</p>
<p>Khi một Box nằm ngoài scope, destructor sẽ được gọi để giải phóng bộ nhớ.
Sử dụng Box không ảnh hưởng nhiều đến performance do Box không bổ sung thêm thông tin metadata nào khác.</p>
<pre><pre class="playground"><code class="language-rust editable edition2021">fn main() {
  let b = Box::new(5);
  println!("b = {}", b);
}</code></pre></pre>
<p>Ở ví dụ trên, chúng ta định nghĩa <code>b</code> có giá trị của <code>Box</code> đang trỏ đến giá trị <code>5</code> và <code>5</code> đang được allocated trên heap. Chương trình sẽ in ra <code>b = 5</code> , cách truy cập giống hệt cách allocated trên stack. Giống như owned value, khi box out of scope, cuối hàm <code>main</code> sẽ được giải phóng.</p>
<p>Lưu một giá trị đơn giản trên Box không mang lại lợi ích gì cả. Chúng ta sẽ thường dùng Box trong các trường hợp sau:</p>
<ol>
<li>Khi bạn có một type mà không biết trước size ở compile time, và bạn cần sử dụng type đó trong một số ngữ cảnh cần biết trước chính xác data size (ví dụ như <em>recursive type)</em>.</li>
<li>Bạn cần xử lý các kiểu dữ liệu nhưng chỉ muốn quan tâm đến type đó được implement trait nào.</li>
<li>Khi bạn có một lượng lớn data cần transfer ownership nhưng muốn chắc là data sẽ không bị copy, sẽ ảnh hưởng đến hiệu năng và làm tăng bộ nhớ.</li>
</ol>
<p>Chúng ta sẽ làm rõ ngay sau đây.</p>
<h1 id="1-recursive-types-với-box"><a class="header" href="#1-recursive-types-với-box">1. Recursive types với <code>Box</code></a></h1>
<p>Tại compile time, Rust cần biết cần phải biết cần bao nhiêu bộ nhớ. Một trong những kiểu dữ liệu mà Rust không biết trước được size là <em>recursive type.</em> Giá trị có thể là một phần của giá trị khác có cùng một kiểu. Bởi vì nesting of values theo lý thuyết có thể kéo dài đến vô hạn. Trong trường hợp này ta có thể dùng <code>Box</code>.</p>
<p><a href="https://en.wikipedia.org/wiki/Cons">Cons list</a> là một kiểu dữ liệu phổ biến trong các ngôn ngữ functional programming,
là một ví dụ của recursive type. Cons là viết tắt của <em>"construct function"</em>.
Mỗi item trong cons list có 2 thành phần: giá trị của item hiện tại và next item.
Item cuối cùng có giá trị Nil và không có next item.</p>
<pre><pre class="playground"><code class="language-rust edition2021"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>enum List {
  Cons(i32, List),
  Nil,
}
<span class="boring">}</span></code></pre></pre>
<p>Bây giờ hãy sử dụng <code>List</code> type để lưu list <code>1, 2, 3</code> như sau</p>
<pre><pre class="playground"><code class="language-rust editable edition2021">enum List {
  Cons(i32, List),
  Nil,
}

use List::{Cons, Nil};

fn main() {
  let list = Cons(1, Cons(2, Cons(3, Nil)));
}</code></pre></pre>
<p>Nếu chúng ta compile đoạn code trên, compiler sẽ báo như sau:</p>
<pre><code class="language-bash">$ cargo run
   Compiling cons-list v0.1.0 (file:///duyet/cons-list)
error[E0072]: recursive type `List` has infinite size
 --&gt; src/main.rs:1:1
  |
1 | enum List {
  | ^^^^^^^^^ recursive type has infinite size
2 |     Cons(i32, List),
  |               ---- recursive without indirection
  |
help: insert some indirection (e.g., a `Box`, `Rc`, or `&amp;`) to make `List` representable
  |
2 |     Cons(i32, Box&lt;List&gt;),
  |               ++++    +

error[E0391]: cycle detected when computing drop-check constraints for `List`
 --&gt; src/main.rs:1:1
  |
1 | enum List {
  | ^^^^^^^^^
  |
  = note: ...which immediately requires computing drop-check constraints for `List` again
  = note: cycle used when computing dropck types for `Canonical { max_universe: U0, variables: [], value: ParamEnvAnd { param_env: ParamEnv { caller_bounds: [], reveal: UserFacing }, value: List } }`

Some errors have detailed explanations: E0072, E0391.
For more information about an error, try `rustc --explain E0072`.
error: could not compile `cons-list` due to 2 previous errors
</code></pre>
<p>Compiler nói rằng kiểu dữ liệu này <em>has infinite size.</em> Bởi vì <code>List</code> có variant là <code>List::Cons</code> chứa trực tiếp một <code>List</code> khác trong chính nó. Do đó Rust sẽ không biết được sẽ cần bao nhiêu bộ nhớ để lưu giá trị của <code>List</code>.</p>
<p>Dừng lại một chút để xem Rust tính toán bộ nhớ của một kiểu dữ liệu bình thường như thế nào:</p>
<pre><pre class="playground"><code class="language-rust edition2021"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>enum Message {
  Quit,
  Move { x: i32, y: i32 },
  Write(String),
  ChangeColor(i32, i32, i32),
}
<span class="boring">}</span></code></pre></pre>
<p>Để xác định bao nhiêu bộ nhớ cần để allocate cho <code>Message</code>, Rust sẽ kiểm tra từng variant (biến thể của enum) để xem variant nào cần bộ nhớ nhiều nhất. Rust thấy rằng <code>Message::Quit</code> không cần, <code>Message::Move</code> phải cần ít nhất bộ nhớ để lưu hai giá trị <code>i32</code>. Tương tự với các variant còn lại. Bởi vì một thời điểm cho có một variant được sử dụng, do đó bộ nhớ tối đa mà <code>Message</code> cần sẽ là một nhớ cần để lưu trữ variant lớn nhất.</p>
<p>Quay lại với Cons List, bộ nhớ mà Rust tính toán được có thể đến vô tận.</p>
<p><img src="./box-cons.svg" alt="" /></p>
<p>Theo như gợi ý của compiler, chúng ta có thể sử dụng <code>Box&lt;T&gt;</code> để có một Recursive Type với một kích thước bộ nhớ xác định:</p>
<pre><code class="language-bash">help: insert some indirection (e.g., a `Box`, `Rc`, or `&amp;`) to make `List` representable
  |
2 |     Cons(i32, Box&lt;List&gt;),
  |               ++++    +
</code></pre>
<p>Bởi vì <code>Box&lt;T&gt;</code> là một pointer, Rust luôn biết chính xác bao nhiêu bộ nhớ mà một <code>Box&lt;T&gt;</code> <strong>pointer</strong> cần.</p>
<p><img src="./box-cons-box.png" alt="" /></p>
<p>Chương trình của chúng ta lúc này sẽ là:</p>
<pre><pre class="playground"><code class="language-rust editable edition2021">enum List {
  Cons(i32, Box&lt;List&gt;),
  Nil,
}

use List::{Cons, Nil};

fn main() {
  let list = Cons(1, Box::new(Cons(2, Box::new(Cons(3, Box::new(Nil))))));
}</code></pre></pre>
<h1 id="2-sử-dụng-trait-objects-cho-phép-sử-dụng-giá-trị-từ-nhiều-kiểu-dữ-liệu-khác-nhau"><a class="header" href="#2-sử-dụng-trait-objects-cho-phép-sử-dụng-giá-trị-từ-nhiều-kiểu-dữ-liệu-khác-nhau">2. Sử dụng <em>trait objects</em> cho phép sử dụng giá trị từ nhiều kiểu dữ liệu khác nhau</a></h1>
<p>Một giới hạn của <code>Vec</code> là chỉ có thể lưu trữ các thành phần có kiểu dữ liệu giống nhau mà thôi. Ta có thể lách luật trong một số trường hợp bằng cách sử dụng enum có nhiều variant giữ nhiều kiểu dữ liệu khác nhau</p>
<pre><pre class="playground"><code class="language-rust edition2021"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>enum Cell {
  Int(i32),
  Float(f64),
  Text(String),
}

let row = vec![
  Cell::Int(3),
  Cell::Text(String::from("blue")),
  Cell::Float(10.12),
];
<span class="boring">}</span></code></pre></pre>
<p>Tuy nhiên, trong một số trường hợp mong muốn thư viện của chúng ta có thể dễ dàng được mở rộng một số trường hợp khác. Chúng ta đã biết được định nghĩa Trait cho các Common Behavior. Trong Rust, trait định nghĩa các hành vi, và các hành vi này có thể được <code>impl</code> cho struct hoặc enum, để giúp một struct hoặc enum mang đặc tính các hành vi đó.</p>
<pre><pre class="playground"><code class="language-rust edition2021"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub trait Draw {
  fn draw(&amp;self);
}

pub struct Screen {
  pub components: Vec&lt;Box&lt;dyn Draw&gt;&gt;,
}

impl Screen {
  pub fn run(&amp;self) {
    for component in self.components.iter() {
      component.draw();
    }
  }
}
<span class="boring">}</span></code></pre></pre>
<p>Hãy xem ví dụ trên, ta có <code>components</code> có kiểu dữ liệu là <code>Vec&lt;T&gt;</code> với <code>&lt;T&gt;</code> là một <code>Box&lt;dyn Draw&gt;</code>. Chúng ta đã định nghĩa một vector chứa kiểu dữ liệu là một <em>trait object</em>.</p>
<p>Một <em>trait object</em> được định nghĩa bằng cách định nghĩa pointer, ví dụ như <code>&amp;dyn T</code> hoặc <code>Box&lt;dyn T&gt;</code> smart pointer.</p>
<p>Một <em>trait object</em> sẽ trỏ đến:</p>
<ul>
<li>một instance của một kiểu dữ liệu có implement trait của chúng ta</li>
<li>và một bảng ghi look up đến các trait methods lúc runtime.</li>
</ul>
<p>Sử dụng trait object, Rust type system sẽ chắc chắn là tại thời điểm compile, tất cả các giá trị sử dụng tại ngữ cảnh đó đều phải được implement trai của <em>trait object</em> đó. Nói tóm lại, chúng ta sẽ không cần quan tâm đó là kiểu dữ liệu gì, chỉ cần biết kiểu dữ liệu đó phải được implement <em>trait</em> chúng ta cần là được.</p>
<p>Lý do cần sử dụng pointer reference <code>&amp;</code> hoặc smart pointer <code>Box&lt;T&gt;</code> bởi vì compiler không biết chính xác về kiểu dữ liệu, Rust sẽ dùng pointer của trait object để biết được method nào để cần được gọi. Xem thêm về <strong><a href="https://doc.rust-lang.org/book/ch17-02-trait-objects.html#trait-objects-perform-dynamic-dispatch">Trait Objects Perform Dynamic Dispatch</a>.</strong></p>
<h1 id="references"><a class="header" href="#references">References</a></h1>
<ul>
<li><a href="https://doc.rust-lang.org/book/ch15-01-box.html">Using Box<T> to Point to Data on the Heap</a></li>
<li><a href="https://doc.rust-lang.org/rust-by-example/std/box.html#box-stack-and-heap">Box, stack and heap - Rust By Example</a></li>
<li><a href="https://doc.rust-lang.org/book/ch17-02-trait-objects.html#using-trait-objects-that-allow-for-values-of-different-types">Using Trait Objects That Allow for Values of Different Types</a></li>
<li><a href="https://doc.rust-lang.org/book/ch19-04-advanced-types.html">Advanced Types - The Rust Programming Language</a></li>
<li><a href="https://doc.rust-lang.org/book/ch04-01-what-is-ownership.html#the-stack-and-the-heap">The Stack and the Heap</a></li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../basic/rustdoc/doc-README.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../advanced/rc.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../basic/rustdoc/doc-README.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../advanced/rc.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>

        <script src="../ace.js"></script>
        <script src="../editor.js"></script>
        <script src="../mode-rust.js"></script>
        <script src="../theme-dawn.js"></script>
        <script src="../theme-tomorrow_night.js"></script>

        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
