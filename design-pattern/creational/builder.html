<!DOCTYPE HTML>
<html lang="vi" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Builder Pattern - Rust Tiếng Việt</title>


        <!-- Custom HTML head -->
        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-88RKF7DLPY"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
        
          gtag('config', 'G-88RKF7DLPY');
        </script>

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../../index.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="../../who-is-using.html"><strong aria-hidden="true">2.</strong> Who is using?</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Cơ bản</li><li class="chapter-item expanded "><a href="../../basic/variables.html"><strong aria-hidden="true">3.</strong> Variables</a></li><li class="chapter-item expanded "><a href="../../basic/cargo/INDEX.html"><strong aria-hidden="true">4.</strong> Cargo</a></li><li class="chapter-item expanded "><a href="../../basic/package-crate/INDEX.html"><strong aria-hidden="true">5.</strong> Packages và Crates</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../basic/package-crate/package-layout.html"><strong aria-hidden="true">5.1.</strong> Package layout</a></li><li class="chapter-item expanded "><a href="../../basic/package-crate/crate.html"><strong aria-hidden="true">5.2.</strong> Crate</a></li></ol></li><li class="chapter-item expanded "><a href="../../basic/ownership.html"><strong aria-hidden="true">6.</strong> Ownership</a></li><li class="chapter-item expanded "><a href="../../basic/variables.html"><strong aria-hidden="true">7.</strong> Variables</a></li><li class="chapter-item expanded "><a href="../../basic/vec/INDEX.html"><strong aria-hidden="true">8.</strong> Vec</a></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">8.1.</strong> Iter</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">8.2.</strong> Sử dụng Enum để chứa nhiều loại dữ liệu</div></li></ol></li><li class="chapter-item expanded "><a href="../../basic/box.html"><strong aria-hidden="true">9.</strong> Box</a></li><li class="chapter-item expanded "><a href="../../basic/option.html"><strong aria-hidden="true">10.</strong> Option</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../basic/unwrap_or_default.html"><strong aria-hidden="true">10.1.</strong> .unwrap_or_default()</a></li></ol></li><li class="chapter-item expanded "><a href="../../basic/result.html"><strong aria-hidden="true">11.</strong> Result</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../basic/result-to-option.html"><strong aria-hidden="true">11.1.</strong> Convert Result sang Option</a></li><li class="chapter-item expanded "><a href="../../basic/question-mark.html"><strong aria-hidden="true">11.2.</strong> Toán tử ?</a></li></ol></li><li class="chapter-item expanded "><a href="../../basic/code-comment.html"><strong aria-hidden="true">12.</strong> /// code comment</a></li><li class="chapter-item expanded "><a href="../../basic/struct.html"><strong aria-hidden="true">13.</strong> Struct</a></li><li class="chapter-item expanded "><a href="../../basic/trait.html"><strong aria-hidden="true">14.</strong> Trait</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../basic/copy-clone.html"><strong aria-hidden="true">14.1.</strong> Copy, Clone</a></li><li class="chapter-item expanded "><a href="../../basic/fromstr.html"><strong aria-hidden="true">14.2.</strong> FromStr</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">14.3.</strong> Display</div></li></ol></li><li class="chapter-item expanded "><a href="../../basic/turbofish.html"><strong aria-hidden="true">15.</strong> Turbofish ::&lt;&gt;</a></li><li class="chapter-item expanded "><a href="../../basic/macro/index.html"><strong aria-hidden="true">16.</strong> macros!</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../basic/macro/println.html"><strong aria-hidden="true">16.1.</strong> println!</a></li><li class="chapter-item expanded "><a href="../../basic/macro/format.html"><strong aria-hidden="true">16.2.</strong> format!</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">16.3.</strong> macro_rules!</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">17.</strong> Rc, Arc</div></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Crates hay dùng</li><li class="chapter-item expanded "><div><strong aria-hidden="true">18.</strong> tokio</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">19.</strong> actix-web</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">20.</strong> anyhow</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">21.</strong> serde</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">22.</strong> clap</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">23.</strong> log</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">24.</strong> config</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">25.</strong> async_trait</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">26.</strong> lazy_static</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">27.</strong> indoc</div></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Design patterns</li><li class="chapter-item expanded "><a href="../../design-pattern/behavioural/index.html"><strong aria-hidden="true">28.</strong> Behavioural Patterns</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../design-pattern/behavioural/strategy.html"><strong aria-hidden="true">28.1.</strong> Strategy Pattern</a></li><li class="chapter-item expanded "><a href="../../design-pattern/behavioural/command.html"><strong aria-hidden="true">28.2.</strong> Command Pattern</a></li></ol></li><li class="chapter-item expanded "><a href="../../design-pattern/creational/index.html"><strong aria-hidden="true">29.</strong> Creational Patterns</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../design-pattern/creational/builder.html" class="active"><strong aria-hidden="true">29.1.</strong> Builder Pattern</a></li></ol></li><li class="chapter-item expanded "><a href="../../design-pattern/structural/index.html"><strong aria-hidden="true">30.</strong> Structural Patterns</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../design-pattern/structural/small-rates.html"><strong aria-hidden="true">30.1.</strong> Prefer Small Crates</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><li class="part-title">Rust Idioms</li><li class="chapter-item expanded affix "><div>Concatenating strings with format!</div></li><li class="chapter-item expanded affix "><div>Constructor</div></li><li class="chapter-item expanded affix "><div>The Default Trait</div></li><li class="chapter-item expanded affix "><div>Finalisation in destructors</div></li><li class="chapter-item expanded affix "><div>Temporary mutability</div></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Rust Tiếng Việt</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/rust-tieng-viet/rust-tieng-viet.github.io" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/rust-tieng-viet/rust-tieng-viet.github.io/edit/main/src/design-pattern/creational/builder.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="rust-builder-design-pattern"><a class="header" href="#rust-builder-design-pattern">Rust Builder Design Pattern</a></h1>
<p>Rust không có overloading, do đó bạn cần phải viết nhiều construct
cho tất cả các trường hợp có thể có, với các method name khác nhau. 
Việc này sẽ cực kỳ mất thời gian nếu struct có quá nhiều <em>fields</em> hoặc <em>constructor</em> phức tạp.</p>
<pre><pre class="playground"><code class="language-rust edition2021"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>impl Foo {
  pub fn new(a: String) -&gt; Self {}
  pub fn new(a: String, b: String) -&gt; Self {} // &lt;-- không thể
  pub fn new(a: i32) -&gt; Self {} // &lt;-- không thể
}

// Thay vào đó
impl Foo {
  pub fn new(a: String) -&gt; Self {}
  pub fn new_from_two(a: String, b: String) -&gt; Self {}
  pub fn new_from_int(a: i32) -&gt; Self {}
}
<span class="boring">}
</span></code></pre></pre>
<p>Do đó, <strong>builder</strong> được sử dụng cực kỳ phổ biến trong Rust so với các ngôn ngữ khác.</p>
<p>Builder cho phép construct một object bằng cách gọi <code>build()</code>.</p>
<h1 id="ví-dụ"><a class="header" href="#ví-dụ">Ví dụ</a></h1>
<pre><pre class="playground"><code class="language-rust edition2021"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>#[derive(Debug, PartialEq)]
pub struct Foo {
  // Lots of complicated fields.
  bar: String,
}

impl Foo {
  // This method will help users to discover the builder
  pub fn builder() -&gt; FooBuilder {
    FooBuilder::default()
  }
}

#[derive(Default)]
pub struct FooBuilder {
  // Probably lots of optional fields.
  bar: String,
}

impl FooBuilder {
  pub fn new(/* ... */) -&gt; FooBuilder {
    // Set the minimally required fields of Foo.
    FooBuilder {
      bar: &quot;x&quot;.to_string(),
    }
  }

  pub fn name(mut self, bar: String) -&gt; FooBuilder {
    // Set the name on the builder itself, and return the builder by value.
    self.bar = bar;
    self
  }

  // If we can get away with not consuming the Builder here, that is an
  // advantage. It means we can use the FooBuilder as a template for constructing
  // many Foos.
  pub fn build(self) -&gt; Foo {
    // Create a Foo from the FooBuilder, applying all settings in FooBuilder
    // to Foo.
    Foo { bar: self.bar }
  }
}

#[test]
fn builder_test() {
  let foo = Foo { bar: &quot;y&quot;.to_string() };
  let foo_from_builder = FooBuilder::new().name(&quot;y&quot;.to_string()).build();

  assert_eq!(foo, foo_from_builder);
}
<span class="boring">}
</span></code></pre></pre>
<h1 id="khi-nào-dùng"><a class="header" href="#khi-nào-dùng">Khi nào dùng</a></h1>
<p>Hữu ích khi bạn muốn có nhiều loại constructors khác nhau hoặc khi constructor có side effects.</p>
<h1 id="Ưu-điểm"><a class="header" href="#Ưu-điểm">Ưu điểm</a></h1>
<ul>
<li>Tách biệt các methods của builder và các method khác của object.</li>
<li>Không cần phải viết quá nhiều constructor nếu struct có quá nhiều fields hoặc quá nhiều cách để khởi tạo một object.</li>
<li>One-liner initialization: <code>FooBuilder::new().a().b().c().build()</code></li>
</ul>
<h1 id="nhược-điểm"><a class="header" href="#nhược-điểm">Nhược điểm</a></h1>
<p>Phức tạp hơn so với việc init object trực tiếp, hoặc so với object có constructor đơn giản.</p>
<h1 id="references"><a class="header" href="#references">References</a></h1>
<ul>
<li><a href="https://doc.rust-lang.org/1.0.0/style/ownership/builders.html">https://doc.rust-lang.org/1.0.0/style/ownership/builders.html</a></li>
<li><a href="https://crates.io/crates/derive_builder">derive_builder</a>, một crate cho phép tự động tạo builder.</li>
<li><a href="https://en.wikipedia.org/wiki/Builder_pattern">Builder pattern (wikipedia)</a></li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../design-pattern/creational/index.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../../design-pattern/structural/index.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../design-pattern/creational/index.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../../design-pattern/structural/index.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->


    </body>
</html>
