<!DOCTYPE HTML>
<html lang="vi" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Prefer Small Crates - Rust Tiếng Việt</title>


        <!-- Custom HTML head -->
        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-88RKF7DLPY"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
        
          gtag('config', 'G-88RKF7DLPY');
        </script>

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../../index.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="../../who-is-using.html"><strong aria-hidden="true">2.</strong> Who is using?</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Cơ bản</li><li class="chapter-item expanded "><a href="../../basic/variables.html"><strong aria-hidden="true">3.</strong> Variables</a></li><li class="chapter-item expanded "><a href="../../basic/cargo/INDEX.html"><strong aria-hidden="true">4.</strong> Cargo</a></li><li class="chapter-item expanded "><a href="../../basic/package-crate/INDEX.html"><strong aria-hidden="true">5.</strong> Packages và Crates</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../basic/package-crate/package-layout.html"><strong aria-hidden="true">5.1.</strong> Package layout</a></li><li class="chapter-item expanded "><a href="../../basic/package-crate/crate.html"><strong aria-hidden="true">5.2.</strong> Crate</a></li><li class="chapter-item expanded "><a href="../../basic/package-crate/use-crate/index.html"><strong aria-hidden="true">5.3.</strong> use crate</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../basic/package-crate/use-crate/self-super.html"><strong aria-hidden="true">5.3.1.</strong> use self, use super</a></li><li class="chapter-item expanded "><a href="../../basic/package-crate/use-crate/pub-use.html"><strong aria-hidden="true">5.3.2.</strong> pub use</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../basic/ownership.html"><strong aria-hidden="true">6.</strong> Ownership</a></li><li class="chapter-item expanded "><a href="../../basic/variables.html"><strong aria-hidden="true">7.</strong> Variables</a></li><li class="chapter-item expanded "><a href="../../basic/vec/INDEX.html"><strong aria-hidden="true">8.</strong> Vec</a></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">8.1.</strong> Iter</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">8.2.</strong> Sử dụng Enum để chứa nhiều loại dữ liệu</div></li></ol></li><li class="chapter-item expanded "><a href="../../basic/box.html"><strong aria-hidden="true">9.</strong> Box</a></li><li class="chapter-item expanded "><a href="../../basic/option.html"><strong aria-hidden="true">10.</strong> Option</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../basic/unwrap.html"><strong aria-hidden="true">10.1.</strong> unwrap()</a></li><li class="chapter-item expanded "><a href="../../basic/expect.html"><strong aria-hidden="true">10.2.</strong> expect()</a></li><li class="chapter-item expanded "><a href="../../basic/unwrap_or_default.html"><strong aria-hidden="true">10.3.</strong> unwrap_or_default()</a></li><li class="chapter-item expanded "><a href="../../basic/if_let_some.html"><strong aria-hidden="true">10.4.</strong> if let Some(x) = x</a></li></ol></li><li class="chapter-item expanded "><a href="../../basic/result.html"><strong aria-hidden="true">11.</strong> Result</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../basic/result-to-option.html"><strong aria-hidden="true">11.1.</strong> Convert Result sang Option</a></li><li class="chapter-item expanded "><a href="../../basic/question-mark.html"><strong aria-hidden="true">11.2.</strong> Toán tử ?</a></li></ol></li><li class="chapter-item expanded "><a href="../../basic/code-comment.html"><strong aria-hidden="true">12.</strong> /// code comment</a></li><li class="chapter-item expanded "><a href="../../basic/struct.html"><strong aria-hidden="true">13.</strong> Struct</a></li><li class="chapter-item expanded "><a href="../../basic/trait.html"><strong aria-hidden="true">14.</strong> Trait</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../basic/copy-clone.html"><strong aria-hidden="true">14.1.</strong> Copy, Clone</a></li><li class="chapter-item expanded "><a href="../../basic/fromstr.html"><strong aria-hidden="true">14.2.</strong> FromStr</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">14.3.</strong> Display</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">15.</strong> Enum</div></li><li class="chapter-item expanded "><a href="../../basic/turbofish.html"><strong aria-hidden="true">16.</strong> Turbofish ::&lt;&gt;</a></li><li class="chapter-item expanded "><a href="../../basic/macro/index.html"><strong aria-hidden="true">17.</strong> macros!</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../basic/macro/println.html"><strong aria-hidden="true">17.1.</strong> println!</a></li><li class="chapter-item expanded "><a href="../../basic/macro/format.html"><strong aria-hidden="true">17.2.</strong> format!</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">17.3.</strong> macro_rules!</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">18.</strong> Rc, Arc</div></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Crates hay dùng</li><li class="chapter-item expanded "><div><strong aria-hidden="true">19.</strong> tokio</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">20.</strong> actix-web</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">21.</strong> anyhow</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">22.</strong> serde</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">23.</strong> clap</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">24.</strong> log</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">25.</strong> config</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">26.</strong> async_trait</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">27.</strong> lazy_static</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">28.</strong> indoc</div></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Design patterns</li><li class="chapter-item expanded "><a href="../../design-pattern/behavioural/index.html"><strong aria-hidden="true">29.</strong> Behavioural Patterns</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../design-pattern/behavioural/strategy.html"><strong aria-hidden="true">29.1.</strong> Strategy Pattern</a></li><li class="chapter-item expanded "><a href="../../design-pattern/behavioural/command.html"><strong aria-hidden="true">29.2.</strong> Command Pattern</a></li></ol></li><li class="chapter-item expanded "><a href="../../design-pattern/creational/index.html"><strong aria-hidden="true">30.</strong> Creational Patterns</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../design-pattern/creational/builder.html"><strong aria-hidden="true">30.1.</strong> Builder Pattern</a></li></ol></li><li class="chapter-item expanded "><a href="../../design-pattern/structural/index.html"><strong aria-hidden="true">31.</strong> Structural Patterns</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../design-pattern/structural/small-rates.html" class="active"><strong aria-hidden="true">31.1.</strong> Prefer Small Crates</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><li class="part-title">Rust Idioms</li><li class="chapter-item expanded affix "><div>Concatenating strings with format!</div></li><li class="chapter-item expanded affix "><div>Constructor</div></li><li class="chapter-item expanded affix "><div>The Default Trait</div></li><li class="chapter-item expanded affix "><div>Finalisation in destructors</div></li><li class="chapter-item expanded affix "><div>Temporary mutability</div></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Rust Tiếng Việt</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/rust-tieng-viet/rust-tieng-viet.github.io" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/rust-tieng-viet/rust-tieng-viet.github.io/edit/main/src/design-pattern/structural/small-rates.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="prefer-small-crates"><a class="header" href="#prefer-small-crates">Prefer Small Crates</a></h1>
<p>Không hẳn là một Design pattern, mình thấy đây là một tư tưởng khi viết các project bằng Rust.</p>
<p>Cargo và <a href="http://crates.io/">crates.io</a> giúp quản lý crate cực kỳ dễ dàng. 
Hơn nữa, crate trên crates.io không thể sửa hoặc xóa được sau khi publish, 
bất kỳ bản build nào đang hoạt động chắc chắn sẽ hoạt động được tiếp trong tương lai. 
Điều này bắt buộc để có được sự hiệu quả, mọi crate phải được thiết kế tốt, 
lựa chọn dependencies kỹ càng và càng nhỏ càng tốt.</p>
<blockquote>
<p>Prefer small crates that do one thing well.</p>
</blockquote>
<h1 id="Ưu-điểm"><a class="header" href="#Ưu-điểm">Ưu điểm</a></h1>
<ul>
<li>Small crate sẽ giúp ta dễ hiểu và dễ sử dụng hơn, code dễ module hóa hơn.</li>
<li>Đơn vị compilation nhỏ nhất của Rust là crate, tách nhỏ project thành nhiều crate giúp code build parallel.</li>
<li>Crate giúp tái sử dụng giữa nhiều project khác nhau.
<ul>
<li>Ví dụ, crate <code>url</code> là một phần của Servo browser engine, nhưng được sử dụng cực kỳ rộng rãi ở các project khác, do nó độc lập và giải quyết một vấn đề cụ thể.</li>
<li>Ví dụ, <a href="https://awslabs.github.io/aws-sdk-rust/">AWS SDK Rust</a> được tách thành rất nhiều crate nhỏ, và các crate nhỏ này được sử dụng ở khắp nơi không chỉ ở AWS SDK Rust.
<ul>
<li><code>aws-sdk-*</code></li>
<li><code>aws-config</code></li>
<li><code>aws_smithy_client</code></li>
<li><code>aws_types</code></li>
</ul>
</li>
</ul>
</li>
<li>Tách nhỏ crate độc lập giúp việc chia tasks trong một project lớn của team hiệu quả hơn.</li>
</ul>
<h1 id="nhược-điểm"><a class="header" href="#nhược-điểm">Nhược điểm</a></h1>
<ul>
<li>Có dễ dẫn đến “dependency hell”, một project depends vào cùng 1 crate nhưng version khác nhau cùng một lúc. Và các versions này xung đột nhau.</li>
<li>Hai crate quá nhỏ có thể kém hiệu quả hơn một crate lớn, bởi vì compiler mặc định không thực hiện link-time optimization (LTO).</li>
</ul>
<h1 id="một-số-small-crates-điển-hình"><a class="header" href="#một-số-small-crates-điển-hình">Một số small crates điển hình</a></h1>
<ul>
<li><a href="https://crates.io/crates/url">url</a>: crate xử lý url.</li>
<li><a href="https://crates.io/crates/ref_slice">ref_slice</a>: crate giúp convert từ <code>&amp;T</code> sang <code>&amp;[T]</code>. Crate này <a href="https://github.com/rust-lang/rust/issues/27774#issuecomment-150058618">từng nằm trong standard library</a> nhưng đã tách ra.</li>
<li><a href="https://crates.io/crates/num_cpus">num_cpus</a>: trả về số lượng cpu trên máy hiện tại.</li>
<li><a href="https://crates.io/crates/rand">rand</a>: random number generators.</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../design-pattern/structural/index.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../design-pattern/structural/index.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->


    </body>
</html>
